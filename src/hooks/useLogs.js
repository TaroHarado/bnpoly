'use client';import*as React from'react';const BUS=(typeof window!=='undefined')?(window.__PC_LOGS__||= {list:[],subs:[]}):{list:[],subs:[]};export function log(type,msg){const it={ts:Date.now(),type,msg};BUS.list.push(it);BUS.list=BUS.list.slice(-1000);BUS.subs.forEach(fn=>fn([...BUS.list]));console.log(`${new Date(it.ts).toISOString()} [${type}] ${msg}`)}export function useLogBus(){const [logs,setLogs]=React.useState(BUS.list);React.useEffect(()=>{const fn=l=>setLogs([...l]);BUS.subs.push(fn);return()=>{BUS.subs=BUS.subs.filter(x=>x!==fn)}},[]);const clear=()=>{BUS.list=[];setLogs([])};return{logs,clear}}
